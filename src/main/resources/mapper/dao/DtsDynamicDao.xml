<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.ttcxy.mapper.dao.DtsDynamicDao">
    <select id="select" resultType="cn.ttcxy.entity.dto.DtsDynamicDto">
        select t1.dynamic_id,t1.text,t1.url,t1.create_time,t1.cover_url,t2.username,t2.nickname
        from dts_dynamic t1, uts_author t2
        where (t1.author_id = #{authorId} or t1.author_id in (select be_author_id from uts_fans t3 where t3.author_id = #{authorId}))
        and t1.author_id = t2.author_id
        <if test="type != null and type != ''">
            and `type` = #{type}
        </if>
        order by create_time desc
    </select>
</mapper>