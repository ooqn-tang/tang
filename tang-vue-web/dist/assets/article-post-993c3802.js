import{G as H,L as O,u as z,d as i,H as U,t as J,x as o,y as n,z as t,C as e,E as u,K as C,D as b,k as K,M as Q,F as k,B as x,l as $,I as A,N as W,J as X,O as Y,P as Z}from"./router-f99ea542.js";import{s as m}from"./request-02cf91c6.js";import{_ as tt,i as et}from"./notice-369b78c3.js";import{d as at,i as st,a as ot}from"./collect-a98c9d76.js";function lt(r){return m({url:"/api/remark",method:"post",data:r})}function nt(r,v){return m({url:`/api/remark/${r}/list`,method:"get",params:{pageNum:v}})}const h=r=>(Y("data-v-aa474f5d"),r=r(),Z(),r),it={class:"row"},rt={class:"col-md-9 col-lg-9 pb-5"},ct={class:"row"},dt={class:"col-lg-12 small-col"},ut={class:"card mb-2 article-body"},mt={key:0,class:"card-body"},_t={id:"title"},ht={class:"time-font"},bt=h(()=>t("hr",null,null,-1)),pt=["innerHTML"],ft={key:1,class:"card-body"},vt={class:"card mb-2 article-body"},kt={class:"card-body"},yt=h(()=>t("label",{for:"exampleFormControlTextarea1",class:"form-label"},"评论",-1)),gt={class:"mb-2"},xt=h(()=>t("button",{class:"btn btn-outline-secondary btn-sm",type:"button"},"表情🙂",-1)),Ct={class:"card mb-2 article-body"},Tt={class:"card-body"},wt={style:{color:"aqua"}},It={class:"col-md-3 col-lg-3 d-md-inline d-none small-col"},Et={key:0,class:"list-group mb-2"},Lt=h(()=>t("a",{class:"list-group-item active"},"专题",-1)),$t=["href"],At={class:"list-group mb-2"},St=h(()=>t("a",{class:"list-group-item active"},[C("推荐"),t("span",{class:"float-end"},"🎇")],-1)),jt=["href"],Nt={class:"navbar fixed-bottom navbar-light bg-light foot-navbar"},Rt={class:"container-fluid"},Bt={class:"col-md-12 col-lg-12 small-col"},Mt=h(()=>t("a",{class:"btn btn-outline-primary btn-sm mini-but",disabled:""},"举报",-1)),Pt=["href"],Vt=h(()=>t("a",{class:"btn btn-outline-primary btn-sm mini-but",onclick:"document.body.scrollTop = document.documentElement.scrollTop = 0"},"⬆TOP",-1)),qt={__name:"article-post",setup(r){const v=O(),T=z();let _=i(1),c=i(v.query.value),w=i(!1),I=i([]),l=i({author:{}}),y=i([{remarkId:"1",text:"alksdjfkajsdf"},{remarkId:"1",text:"alksdjfkajsdf"}]),E=i(!1),g=i([]),p=i(0),S=i("加载中..."),f=i({});function L(a){_.value==2?m({url:`/api/fans/${a}`,method:"POST"}).then(d=>{_.value=1}):m({url:`/api/fans/${a}`,method:"DELETE"}).then(d=>{_.value=2})}function j(){f.value.dataId=c,lt(f.value).then(a=>{y.value.unshift(a.data),f.value.text=""})}function N(){nt(c,0).then(a=>{y.value=a.data.content})}function R(){m({url:`/api/fans/username/${l.value.author.username}`,method:"get"}).then(a=>{a.data==1?_.value=1:_.value=2})}function B(){p.value>=1?at({url:window.location.href}).then(a=>{p.value=0}):st({dataId:c,url:window.location.href,title:l.value.title,synopsis:l.value.synopsis}).then(a=>{p.value=1})}function M(){ot({url:window.location.href}).then(a=>{p.value=a.data})}function P(){m({url:`/api/article/load/${c}`,method:"GET"}).then(a=>{l.value=a.data,E.value=T.username==l.value.author.username,R()})}function V(){m({url:`/api/subject/article/${c}`,method:"GET"}).then(a=>{g=a.data})}function q(){m({url:"/api/article/recommend",method:"GET"}).then(a=>{I.value=a.data})}function D(){c=v.params.id,T.username!=""&&M(),V(),P()}return U(()=>{D(),q(),N()}),(a,d)=>{const F=J("router-link");return o(),n(k,null,[t("div",it,[t("div",rt,[t("div",ct,[t("div",dt,[t("div",ut,[e(w)?b("",!0):(o(),n("div",mt,[t("h3",_t,[t("strong",null,u(e(l).title),1)]),t("div",null,[t("strong",null,u(e(l).author.nickname),1),C(" . "),t("span",ht,u(e(l).createTime),1),e(_)==2?(o(),n("button",{key:0,class:"btn btn-outline-warning float-end t-b-m-1",onClick:d[0]||(d[0]=s=>L(e(l).author.username))}," 订阅 ")):b("",!0),e(_)==1?(o(),n("button",{key:1,class:"btn btn-outline-warning float-end t-b-m-1",onClick:d[1]||(d[1]=s=>L(e(l).author.username))}," 取消订阅 ")):b("",!0),bt]),t("div",{class:"markdown-body",innerHTML:e(l).text},null,8,pt)])),e(w)?(o(),n("div",ft,u(e(S)),1)):b("",!0)]),t("div",vt,[t("div",kt,[yt,t("div",gt,[K(t("textarea",{class:"form-control",rows:"3",placeholder:"输入的内容不包含标签的内容会在最后追加标签中的内容。","onUpdate:modelValue":d[2]||(d[2]=s=>e(f).text=s)},null,512),[[Q,e(f).text]])]),xt,t("button",{class:"btn btn-outline-secondary btn-sm float-end",type:"button",onClick:j},"发送")])]),(o(!0),n(k,null,x(e(y),s=>(o(),n("div",Ct,[t("div",Tt,[t("p",wt,u(s.author!=null?s.author.nickname:"未知"),1),t("p",null,u(s.text),1)])]))),256))])])]),t("div",It,[e(g).length>0?(o(),n("div",Et,[Lt,(o(!0),n(k,null,x(e(g),(s,G)=>(o(),n("a",{class:A(["list-group-item",s.articleId==e(l).articleId?"active2":""]),href:"/article/"+s.articleId},[t("div",null,u(s.title),1)],10,$t))),256))])):b("",!0),t("div",At,[St,(o(!0),n(k,null,x(e(I),(s,G)=>(o(),n("a",{class:"list-group-item",href:"/article/"+s.articleId},u(s.title),9,jt))),256))]),$(tt),$(et)])]),t("nav",Nt,[t("div",Rt,[t("div",Bt,[t("a",{class:A([e(p)==1?"btn-outline-danger":"btn-outline-primary","btn btn-sm mini-but m-l-0"]),onClick:B},"收藏",2),Mt,t("a",{class:"btn btn-outline-primary btn-sm mini-but",href:"https://api.ooqn.com/article/"+e(c),target:"_blank"},"阅读模式",8,Pt),e(E)?(o(),W(F,{key:0,class:"btn btn-outline-primary btn-sm mini-but",target:"_blank",to:{name:"article-editor-md",query:{article:e(c)}}},{default:X(()=>[C("修改")]),_:1},8,["to"])):b("",!0),Vt])])])],64)}}},Ot=H(qt,[["__scopeId","data-v-aa474f5d"]]);export{Ot as default};
