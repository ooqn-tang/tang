import{I as D,L as F,u as H,d as n,J as O,t as j,x as o,y as l,z as t,C as e,F as g,B as E,E as u,G as m,H as y,l as L,K as $,M as z,D as R,N as J,O as K}from"./router-06300e9b.js";import{s as _}from"./request-90d4e0a2.js";import{_ as U,i as Q}from"./notice-1b0d3051.js";import{d as W,i as X,a as Y}from"./collect-fce7c4cd.js";const p=b=>(J("data-v-29b205be"),b=b(),K(),b),Z={class:"row"},tt={class:"col-md-3 col-lg-3 d-md-inline d-none"},et={key:0,class:"list-group mb-2"},st=p(()=>t("a",{class:"list-group-item active"},"专题",-1)),at=["href"],ot={class:"list-group mb-2"},lt=p(()=>t("a",{class:"list-group-item active"},[y("推荐"),t("span",{class:"float-end"},"🎇")],-1)),nt=["href"],it={class:"col-md-9 col-lg-9 pb-5"},rt={class:"row"},ct={class:"col-lg-8"},dt={class:"card mb-2 article-body"},ut={key:0,class:"card-body"},mt={class:"time-font"},_t=["innerHTML"],ht={key:1,class:"card-body"},bt={class:"col-md-4 mb-2"},pt={class:"navbar fixed-bottom navbar-light bg-light foot-navbar"},ft={class:"container-fluid"},vt={class:"col-md-12 col-lg-12"},gt=p(()=>t("a",{class:"btn btn-outline-primary btn-sm mini-but",disabled:""},"举报",-1)),yt=["href"],kt=p(()=>t("a",{class:"btn btn-outline-primary btn-sm mini-but",onclick:"document.body.scrollTop = document.documentElement.scrollTop = 0"},"⬆TOP",-1)),Ct={__name:"article-post",setup(b){const k=F(),C=H();let r=n(1),c=n(k.query.value),T=n(!1),w=n([]),a=n({article:{},author:{}}),I=n(!1),f=n([]),h=n(0),S=n("加载中...");function x(s){r.value==2?_({url:`/api/fans/${s}`,method:"POST"}).then(d=>{r.value=1}):_({url:`/api/fans/${s}`,method:"DELETE"}).then(d=>{r.value=2})}function A(){_({url:`/api/fans/username/${a.value.author.username}`,method:"get"}).then(s=>{s.data==1?r.value=1:r.value=2})}function B(){h.value>=1?W({url:window.location.href}).then(s=>{h.value=0}):X({dataId:c,url:window.location.href,title:a.value.title,synopsis:a.value.synopsis}).then(s=>{h.value=1})}function N(){Y({url:window.location.href}).then(s=>{h.value=s.data})}function G(){_({url:`/api/article/load/${c}`,method:"GET"}).then(s=>{a.value=s.data,I.value=C.username==a.value.author.username,A()})}function M(){_({url:`/api/subject/article/${c}`,method:"GET"}).then(s=>{f=s.data})}function P(){_({url:"/api/article/recommend",method:"GET"}).then(s=>{w.value=s.data})}function V(){c=k.params.id,C.username!=""&&N(),M(),G()}return O(()=>{V(),P()}),(s,d)=>{const q=j("router-link");return o(),l(g,null,[t("div",Z,[t("div",tt,[e(f).length>0?(o(),l("div",et,[st,(o(!0),l(g,null,E(e(f),(i,v)=>(o(),l("a",{class:$(["list-group-item",i.articleId==e(a).articleId?"active2":""]),key:v,href:"/article/"+i.articleId},[t("div",null,m(i.title),1)],10,at))),128))])):u("",!0),t("div",ot,[lt,(o(!0),l(g,null,E(e(w),(i,v)=>(o(),l("a",{class:"list-group-item",key:v,href:"/article/"+i.articleId},m(i.title),9,nt))),128))])]),t("div",it,[t("div",rt,[t("div",ct,[t("div",dt,[e(T)?u("",!0):(o(),l("div",ut,[t("div",null,[t("strong",null,m(e(a).author.nickname),1),y(" . "),t("span",mt,m(e(a).createTime),1),e(r)==2?(o(),l("button",{key:0,class:"btn btn-outline-warning float-end t-b-m-1",onClick:d[0]||(d[0]=i=>x(e(a).author.username))}," 订阅 ")):u("",!0),e(r)==1?(o(),l("button",{key:1,class:"btn btn-outline-warning float-end t-b-m-1",onClick:d[1]||(d[1]=i=>x(e(a).author.username))}," 取消订阅 ")):u("",!0)]),t("h3",null,[t("strong",null,m(e(a).title),1)]),t("div",{class:"markdown-body",innerHTML:e(a).text},null,8,_t)])),e(T)?(o(),l("div",ht,m(e(S)),1)):u("",!0)])]),t("div",bt,[L(U),L(Q)])])])]),t("nav",pt,[t("div",ft,[t("div",vt,[t("a",{class:$([e(h)==1?"btn-outline-danger":"btn-outline-primary","btn btn-sm mini-but m-l-0"]),onClick:B},"收藏",2),gt,t("a",{class:"btn btn-outline-primary btn-sm mini-but",href:"https://api.ooqn.com/article/"+e(c),target:"_blank"},"阅读模式",8,yt),e(I)?(o(),z(q,{key:0,class:"btn btn-outline-primary btn-sm mini-but",target:"_blank",to:{name:"article-editor-md",query:{article:e(c)}}},{default:R(()=>[y("修改")]),_:1},8,["to"])):u("",!0),kt])])])],64)}}},Et=D(Ct,[["__scopeId","data-v-29b205be"]]);export{Et as default};
