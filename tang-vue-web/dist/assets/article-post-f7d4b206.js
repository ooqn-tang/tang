import{G,L as H,u as O,d as i,H as z,t as U,x as o,y as n,z as t,C as e,E as u,K as w,D as b,k as J,M as K,F as k,B as x,l as E,I as S,N as Q,J as W,O as X,P as Y}from"./router-b176819d.js";import{s as _}from"./request-02cf91c6.js";import{_ as Z,i as tt}from"./notice-fc180054.js";import{d as et,i as st,a as at}from"./collect-a98c9d76.js";import{a as ot}from"./subject-8607d500.js";function lt(r){return _({url:"/api/remark",method:"post",data:r})}function nt(r,v){return _({url:`/api/remark/${r}/list`,method:"get",params:{pageNum:v}})}const h=r=>(X("data-v-cc18c654"),r=r(),Y(),r),it={class:"row"},rt={class:"col-md-9 col-lg-9 pb-5"},ct={class:"row"},dt={class:"col-lg-12 small-col"},ut={class:"card mb-2 article-body"},mt={key:0,class:"card-body"},_t={id:"title"},ht={class:"time-font"},bt=h(()=>t("hr",null,null,-1)),pt=["innerHTML"],ft={key:1,class:"card-body"},vt={class:"card mb-2 article-body"},kt={class:"card-body"},yt=h(()=>t("label",{for:"exampleFormControlTextarea1",class:"form-label"},"评论",-1)),gt={class:"mb-2"},xt=h(()=>t("button",{class:"btn btn-outline-secondary btn-sm",type:"button"},"表情🙂",-1)),wt={class:"card mb-2 article-body"},Ct={class:"card-body"},It={style:{color:"aqua"}},Tt={class:"col-md-3 col-lg-3 d-md-inline d-none small-col"},At={key:0,class:"list-group mb-2"},Lt=h(()=>t("a",{class:"list-group-item active"},"专题",-1)),Et=["href"],St={class:"list-group mb-2"},$t=h(()=>t("a",{class:"list-group-item active"},[w("推荐"),t("span",{class:"float-end"},"🎇")],-1)),jt=["href"],Nt={class:"navbar fixed-bottom navbar-light bg-light foot-navbar"},Rt={class:"container-fluid"},Bt={class:"col-md-12 col-lg-12 small-col"},Mt=h(()=>t("a",{class:"btn btn-outline-primary btn-sm mini-but",disabled:""},"举报",-1)),Pt=["href"],Vt=h(()=>t("a",{class:"btn btn-outline-primary btn-sm mini-but",onclick:"document.body.scrollTop = document.documentElement.scrollTop = 0"},"⬆TOP",-1)),qt={__name:"article-post",setup(r){const v=H(),C=O();let m=i(1),c=i(v.query.value),I=i(!1),T=i([]),l=i({author:{}}),y=i([{remarkId:"1",text:"alksdjfkajsdf"},{remarkId:"1",text:"alksdjfkajsdf"}]),A=i(!1),g=i([]),p=i(0),$=i("加载中..."),f=i({});function L(s){m.value==2?_({url:`/api/fans/${s}`,method:"POST"}).then(d=>{m.value=1}):_({url:`/api/fans/${s}`,method:"DELETE"}).then(d=>{m.value=2})}function j(){f.value.dataId=c,lt(f.value).then(s=>{y.value.unshift(s.data),f.value.text=""})}function N(){nt(c,0).then(s=>{y.value=s.data.content})}function R(){_({url:`/api/fans/username/${l.value.author.username}`,method:"get"}).then(s=>{s.data==1?m.value=1:m.value=2})}function B(){p.value>=1?et({url:window.location.href}).then(s=>{p.value=0}):st({dataId:c,url:window.location.href,title:l.value.title,synopsis:l.value.synopsis}).then(s=>{p.value=1})}function M(){at({url:window.location.href}).then(s=>{p.value=s.data})}function P(){_({url:`/api/article/load/${c}`,method:"GET"}).then(s=>{l.value=s.data,A.value=C.username==l.value.author.username,R()})}function V(){ot(c).then(s=>{g.value=s.data})}function q(){_({url:"/api/article/recommend",method:"GET"}).then(s=>{T.value=s.data})}function D(){c=v.params.id,C.username!=""&&M(),V(),P()}return z(()=>{D(),q(),N()}),(s,d)=>{const F=U("router-link");return o(),n(k,null,[t("div",it,[t("div",rt,[t("div",ct,[t("div",dt,[t("div",ut,[e(I)?b("",!0):(o(),n("div",mt,[t("h3",_t,[t("strong",null,u(e(l).title),1)]),t("div",null,[t("strong",null,u(e(l).author.nickname),1),w(" . "),t("span",ht,u(e(l).createTime),1),e(m)==2?(o(),n("button",{key:0,class:"btn btn-outline-warning float-end t-b-m-1",onClick:d[0]||(d[0]=a=>L(e(l).author.username))}," 订阅 ")):b("",!0),e(m)==1?(o(),n("button",{key:1,class:"btn btn-outline-warning float-end t-b-m-1",onClick:d[1]||(d[1]=a=>L(e(l).author.username))}," 取消订阅 ")):b("",!0),bt]),t("div",{class:"markdown-body",innerHTML:e(l).text},null,8,pt)])),e(I)?(o(),n("div",ft,u(e($)),1)):b("",!0)]),t("div",vt,[t("div",kt,[yt,t("div",gt,[J(t("textarea",{class:"form-control",rows:"3",placeholder:"输入的内容不包含标签的内容会在最后追加标签中的内容。","onUpdate:modelValue":d[2]||(d[2]=a=>e(f).text=a)},null,512),[[K,e(f).text]])]),xt,t("button",{class:"btn btn-outline-secondary btn-sm float-end",type:"button",onClick:j},"发送")])]),(o(!0),n(k,null,x(e(y),a=>(o(),n("div",wt,[t("div",Ct,[t("p",It,u(a.author!=null?a.author.nickname:"未知"),1),t("p",null,u(a.text),1)])]))),256))])])]),t("div",Tt,[e(g).length>0?(o(),n("div",At,[Lt,(o(!0),n(k,null,x(e(g),a=>(o(),n("a",{class:S(["list-group-item",a.articleId==e(l).articleId?"active2":""]),href:"/article/"+a.articleId},[t("div",null,u(a.title),1)],10,Et))),256))])):b("",!0),t("div",St,[$t,(o(!0),n(k,null,x(e(T),a=>(o(),n("a",{class:"list-group-item",href:"/article/"+a.articleId},u(a.title),9,jt))),256))]),E(Z),E(tt)])]),t("nav",Nt,[t("div",Rt,[t("div",Bt,[t("a",{class:S([e(p)==1?"btn-outline-danger":"btn-outline-primary","btn btn-sm mini-but m-l-0"]),onClick:B},"收藏",2),Mt,t("a",{class:"btn btn-outline-primary btn-sm mini-but",href:"https://www.ooqn.com/article/"+e(c),target:"_blank"},"阅读模式",8,Pt),e(A)?(o(),Q(F,{key:0,class:"btn btn-outline-primary btn-sm mini-but",target:"_blank",to:{name:"article-editor-md",query:{article:e(c)}}},{default:W(()=>[w("修改")]),_:1},8,["to"])):b("",!0),Vt])])])],64)}}},zt=G(qt,[["__scopeId","data-v-cc18c654"]]);export{zt as default};
