import{I as D,L as F,u as H,d as n,J as O,t as j,x as a,y as o,z as t,C as e,F as g,B as E,E as u,G as m,H as y,l as L,K as $,M as z,D as R,N as J,O as K}from"./router-2d2d1606.js";import{s as _}from"./request-90d4e0a2.js";import{_ as U,i as Q}from"./notice-4adee1b0.js";import{d as W,i as X,a as Y}from"./collect-fce7c4cd.js";const f=p=>(J("data-v-e26393f1"),p=p(),K(),p),Z={class:"row"},tt={class:"col-md-3 col-lg-3 d-md-inline d-none small-col"},et={key:0,class:"list-group mb-2"},st=f(()=>t("a",{class:"list-group-item active"},"专题",-1)),lt=["href"],at={class:"list-group mb-2"},ot=f(()=>t("a",{class:"list-group-item active"},[y("推荐"),t("span",{class:"float-end"},"🎇")],-1)),nt=["href"],it={class:"col-md-9 col-lg-9 pb-5 small-col"},ct={class:"row"},rt={class:"col-lg-8 small-col"},dt={class:"card mb-2 article-body"},ut={key:0,class:"card-body"},mt={class:"time-font"},_t=["innerHTML"],ht={key:1,class:"card-body"},pt={class:"col-md-4 mb-2 small-col"},ft={class:"navbar fixed-bottom navbar-light bg-light foot-navbar"},bt={class:"container-fluid"},vt={class:"col-md-12 col-lg-12 small-col"},gt=f(()=>t("a",{class:"btn btn-outline-primary btn-sm mini-but",disabled:""},"举报",-1)),yt=["href"],kt=f(()=>t("a",{class:"btn btn-outline-primary btn-sm mini-but",onclick:"document.body.scrollTop = document.documentElement.scrollTop = 0"},"⬆TOP",-1)),Ct={__name:"article-post",setup(p){const k=F(),C=H();let c=n(1),r=n(k.query.value),T=n(!1),w=n([]),l=n({article:{},author:{}}),I=n(!1),b=n([]),h=n(0),S=n("加载中...");function x(s){c.value==2?_({url:`/api/fans/${s}`,method:"POST"}).then(d=>{c.value=1}):_({url:`/api/fans/${s}`,method:"DELETE"}).then(d=>{c.value=2})}function A(){_({url:`/api/fans/username/${l.value.author.username}`,method:"get"}).then(s=>{s.data==1?c.value=1:c.value=2})}function B(){h.value>=1?W({url:window.location.href}).then(s=>{h.value=0}):X({dataId:r,url:window.location.href,title:l.value.title,synopsis:l.value.synopsis}).then(s=>{h.value=1})}function N(){Y({url:window.location.href}).then(s=>{h.value=s.data})}function G(){_({url:`/api/article/load/${r}`,method:"GET"}).then(s=>{l.value=s.data,I.value=C.username==l.value.author.username,A()})}function M(){_({url:`/api/subject/article/${r}`,method:"GET"}).then(s=>{b=s.data})}function P(){_({url:"/api/article/recommend",method:"GET"}).then(s=>{w.value=s.data})}function V(){r=k.params.id,C.username!=""&&N(),M(),G()}return O(()=>{V(),P()}),(s,d)=>{const q=j("router-link");return a(),o(g,null,[t("div",Z,[t("div",tt,[e(b).length>0?(a(),o("div",et,[st,(a(!0),o(g,null,E(e(b),(i,v)=>(a(),o("a",{class:$(["list-group-item",i.articleId==e(l).articleId?"active2":""]),key:v,href:"/article/"+i.articleId},[t("div",null,m(i.title),1)],10,lt))),128))])):u("",!0),t("div",at,[ot,(a(!0),o(g,null,E(e(w),(i,v)=>(a(),o("a",{class:"list-group-item",key:v,href:"/article/"+i.articleId},m(i.title),9,nt))),128))])]),t("div",it,[t("div",ct,[t("div",rt,[t("div",dt,[e(T)?u("",!0):(a(),o("div",ut,[t("div",null,[t("strong",null,m(e(l).author.nickname),1),y(" . "),t("span",mt,m(e(l).createTime),1),e(c)==2?(a(),o("button",{key:0,class:"btn btn-outline-warning float-end t-b-m-1",onClick:d[0]||(d[0]=i=>x(e(l).author.username))}," 订阅 ")):u("",!0),e(c)==1?(a(),o("button",{key:1,class:"btn btn-outline-warning float-end t-b-m-1",onClick:d[1]||(d[1]=i=>x(e(l).author.username))}," 取消订阅 ")):u("",!0)]),t("h3",null,[t("strong",null,m(e(l).title),1)]),t("div",{class:"markdown-body",innerHTML:e(l).text},null,8,_t)])),e(T)?(a(),o("div",ht,m(e(S)),1)):u("",!0)])]),t("div",pt,[L(U),L(Q)])])])]),t("nav",ft,[t("div",bt,[t("div",vt,[t("a",{class:$([e(h)==1?"btn-outline-danger":"btn-outline-primary","btn btn-sm mini-but m-l-0"]),onClick:B},"收藏",2),gt,t("a",{class:"btn btn-outline-primary btn-sm mini-but",href:"https://api.ooqn.com/article/"+e(r),target:"_blank"},"阅读模式",8,yt),e(I)?(a(),z(q,{key:0,class:"btn btn-outline-primary btn-sm mini-but",target:"_blank",to:{name:"article-editor-md",query:{article:e(r)}}},{default:R(()=>[y("修改")]),_:1},8,["to"])):u("",!0),kt])])])],64)}}},Et=D(Ct,[["__scopeId","data-v-e26393f1"]]);export{Et as default};
