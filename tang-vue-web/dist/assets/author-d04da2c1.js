import{s as A}from"./request-596b05ba.js";import{l as D,u as b}from"./role-72a181a8.js";import{N as z,a as E}from"./DrawerContent-30dd205b.js";import{a as r,H as T,q as V,t as $,j as t,A as a,z as o,F as g,C as i,h as f}from"./preload-helper-bcb988a1.js";import{a as c,b as w}from"./Space-e34cae3e.js";import{G as s}from"./Dropdown-75613afe.js";import"./admin-c95e2250.js";import"./use-is-composing-448199b7.js";function q(n){return A({url:`api/admin/role/author/${n}`,method:"get"})}function F(n){return A({url:"/api/admin/author",method:"GET",params:n})}const P={__name:"author",setup(n){const d=r(!1),p=r([]),h=r([]),k=r([]),m=r([]),C=r({}),v=r({}),R=[{title:"用户名",key:"username"},{title:"昵称",key:"nickname"},{title:"邮箱",key:"mail"},{title:"操作",key:"actions",width:"250",render(e){return f(c,[f(s,{size:"small",onClick:async()=>{m.value=[],q(e.authorId).then(l=>{for(let u of l.data)m.value.push(u.roleId)}),v.value=e,d.value=!0}},{default:()=>"角色"}),f(s,{size:"small",onClick:()=>sendMail(e)},{default:()=>"编辑"})])}}],_=[{type:"selection"},{title:"名称",key:"roleName"},{title:"值",key:"roleValue"}],N=e=>e.roleId,y=()=>{F(C.value).then(e=>{p.value=e.data})},I=()=>{D().then(e=>{h.value=e.data})},x=e=>{k.value=e},B=()=>{b(v.value.authorId,k.value)};return T(async()=>{y(),I()}),(e,l)=>(V(),$(g,null,[t(o(c),{vertical:""},{default:a(()=>[t(o(c),null,{default:a(()=>[t(o(s),{type:"primary",onClick:y},{default:a(()=>[i("查询")]),_:1})]),_:1}),t(o(w),{columns:R,data:p.value,bordered:!0},null,8,["data"])]),_:1}),t(o(E),{show:d.value,"onUpdate:show":l[2]||(l[2]=u=>d.value=u),width:600},{default:a(()=>[t(o(z),null,{header:a(()=>[i(" 角色管理 ")]),footer:a(()=>[t(o(c),null,{default:a(()=>[t(o(s),{onClick:l[0]||(l[0]=u=>B())},{default:a(()=>[i("保存")]),_:1}),t(o(s),{onClick:l[1]||(l[1]=u=>d.value=!1)},{default:a(()=>[i("取消")]),_:1})]),_:1})]),default:a(()=>[t(o(w),{columns:_,data:h.value,"row-key":N,"default-checked-row-keys":m.value,"onUpdate:checkedRowKeys":x},null,8,["data","default-checked-row-keys"])]),_:1})]),_:1},8,["show"])],64))}};export{P as default};
