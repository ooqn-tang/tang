import{u as L,J as S,a as r,H as U,l as B,q as n,t as i,x as e,F as h,y as E,z as l,P as f,B as p,g as y,K as j,j as V,A as $,D as x}from"./preload-helper-b3ec2021.js";import{s as m}from"./request-596b05ba.js";const D={class:"list-group article-list"},w={class:"list-group-item"},P=["textContent"],A={class:"btn-group float-end"},J=["onClick"],O=["onClick"],R={class:"synopsis"},q={key:0,class:"list-group-item"},z={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},G={class:"modal-dialog"},H={class:"modal-content"},K=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"专辑"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Q={class:"modal-body"},W={class:"mb-3"},X=e("label",{for:"exampleFormControlInput1",class:"form-label"},"专辑名",-1),Y={class:"mb-3"},Z=e("label",{for:"exampleFormControlTextarea1",class:"form-label"},"描述",-1),ee={class:"modal-footer"},oe={__name:"subject",setup(te){let g=L(),k=S(),b=r(null),u=r(!1),c=r([]),t=r({subjectId:"",subjectName:"",synopsis:""}),d=r("update"),_=k.params.username;function C(s){m({url:`/api/subject/username/${s}`,method:"GET"}).then(a=>{c.value=a.data})}function N(){d.value=="insert"?m({url:"/api/subject",method:"POST",data:t.value}).then(s=>{c.value.unshift(s.data),b.value.click()}):m({url:"/api/subject",method:"PUT",data:t.value}).then(s=>{alert(JSON.stringify(s.data)),b.value.click()})}function T(s){t.value.subjectId=s.subjectId,t.value.subjectName=s.subjectName,t.value.synopsis=s.synopsis,d.value="update"}function F(s,a){confirm("确认删除吗？")&&m({url:`/api/subject/${s}`,method:"DELETE"}).then(v=>{c.value.splice(a,1)})}return U(()=>{C(_),u.value=_==g.author.username}),(s,a)=>{const v=B("router-link");return n(),i(h,null,[e("ul",D,[(n(!0),i(h,null,E(l(c),(o,I)=>(n(),i("li",w,[V(v,{to:{name:"subject_post",params:{subject_id:o.subjectId}}},{default:$(()=>[e("strong",{textContent:x(o.subjectName)},null,8,P)]),_:2},1032,["to"]),e("div",A,[l(u)?(n(),i("button",{key:0,class:"btn btn-outline-danger float-end btn-sm ssm",onClick:M=>F(o.subjectId,I)},"删除",8,J)):p("",!0),l(u)?(n(),i("button",{key:1,class:"btn btn-outline-danger float-end btn-sm ssm",onClick:M=>T(o),"data-bs-toggle":"modal","data-bs-target":"#exampleModal"},"修改",8,O)):p("",!0)]),e("div",R,x(o.synopsis),1)]))),256)),l(u)?(n(),i("li",q,[e("a",{"data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:a[0]||(a[0]=o=>(f(t)?t.value={}:t={},f(d)?d.value="insert":d="insert"))},"创建专辑")])):p("",!0)]),e("div",z,[e("div",G,[e("div",H,[K,e("div",Q,[e("div",W,[X,y(e("input",{class:"form-control",id:"exampleFormControlInput1","onUpdate:modelValue":a[1]||(a[1]=o=>l(t).subjectName=o)},null,512),[[j,l(t).subjectName]])]),e("div",Y,[Z,y(e("textarea",{class:"form-control",id:"exampleFormControlTextarea1",rows:"3","onUpdate:modelValue":a[2]||(a[2]=o=>l(t).synopsis=o)},null,512),[[j,l(t).synopsis]])])]),e("div",ee,[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",ref_key:"close",ref:b},"关闭",512),e("button",{type:"button",class:"btn btn-primary",onClick:N},"保存")])])])])],64)}}};export{oe as default};
