import{I as g,d as v,R as b,t as y,x as w,y as x,z as t,H as i,G as S,C as a,k as u,P as p,l as _,D as m,N as I,O as k}from"./router-ed88fd40.js";import{s as d}from"./request-1bb69c34.js";async function N(o){return d({url:"/api/authenticate",method:"post",data:o})}function R(){return d({url:"/api/author/roles",method:"get"})}function V(){return d({url:"/api/author/info",method:"get"})}const c=o=>(I("data-v-03c8a2b6"),o=o(),k(),o),C={class:"modal",style:{display:"inline"}},D={id:"loginModal",class:"modal-dialog"},A={class:"modal-content"},B=c(()=>t("div",{class:"modal-header"},[t("h4",{class:"modal-title text-center"},"登录")],-1)),M={id:"model-body",class:"modal-body"},O=c(()=>t("label",null,"邮箱/用户名：",-1)),W={class:"form-group"},J=c(()=>t("label",null,"密码：",-1)),T={class:"form-group"},U={class:"modal-footer"},j={class:"btn-group W100"},z={class:"btn-group W100"},E={class:"btn-group W100"},G={__name:"login",setup(o){let s=v({rememberMe:!0}),h=b();async function f(){let r=await N(s.value);if(r.status===200){localStorage.setItem("jwt",r.data);let e=await V(),l=await R();localStorage.setItem("author",JSON.stringify(e.data)),localStorage.setItem("roles",JSON.stringify(l.data)),h.push({path:"/author/"+e.data.username})}}return(r,e)=>{const l=y("router-link");return w(),x("div",C,[t("div",D,[t("div",A,[B,t("div",M,[i(S(a(s).value)+" ",1),O,t("div",W,[u(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=n=>a(s).username=n),placeholder:"邮箱/用户名",autocomplete:"off",class:"form-control"},null,512),[[p,a(s).username]])]),J,t("div",T,[u(t("input",{type:"password","onUpdate:modelValue":e[1]||(e[1]=n=>a(s).password=n),placeholder:"密码",autocomplete:"off",class:"form-control"},null,512),[[p,a(s).password]])])]),t("div",U,[t("div",j,[t("button",{type:"button",class:"btn btn-primary",onClick:e[2]||(e[2]=n=>f())},"登录")]),t("div",z,[_(l,{to:"/register",type:"button",class:"btn btn-outline-secondary"},{default:m(()=>[i("注册")]),_:1})]),t("div",E,[_(l,{to:"/",type:"button",class:"btn btn-outline-secondary"},{default:m(()=>[i("返回首页")]),_:1})])])])])])}}},$=g(G,[["__scopeId","data-v-03c8a2b6"]]);export{$ as default};
