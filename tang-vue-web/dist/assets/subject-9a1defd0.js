import{b as E,j as d,B as U,C as i,D as e,I as j,O as B,F as l,A as y,G as g,u as x,R as C,L as V,J as $,o as c,v as w,E as D,H as k,P as O,Q as P,r as R}from"./github-6eaaf46c.js";import{s as m}from"./request-55ac77c7.js";const v=u=>(O("data-v-2dfc8930"),u=u(),P(),u),G={class:"list-group article-list"},J=["textContent"],A={class:"btn-group float-end"},H=["onClick"],Q=["onClick"],q={key:0,class:"list-group-item"},z={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},K={class:"modal-dialog"},W={class:"modal-content"},X=v(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"专辑"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),Y={class:"modal-body"},Z={class:"mb-3"},ee=v(()=>e("label",{for:"exampleFormControlInput1",class:"form-label"},"专辑名",-1)),te={class:"mb-3"},se=v(()=>e("label",{for:"exampleFormControlTextarea1",class:"form-label"},"描述",-1)),ae={class:"modal-footer"},oe={__name:"subject",setup(u){let I=V(),N=$(),p=d(null),_=d(!1),r=d([]),t=d({subjectId:"",subjectName:"",synopsis:""}),n=d("update"),f=N.params.username;function T(o){m({url:`/api/subject/username/${o}`,method:"GET"}).then(s=>{r.value=s.data})}function S(){n.value=="insert"?m({url:"/api/subject",method:"POST",data:t.value}).then(o=>{r.value.unshift(o.data),p.value.click()}):m({url:"/api/subject",method:"PUT",data:t.value}).then(o=>{alert(JSON.stringify(o.data)),p.value.click()})}function F(o,s,b){t.value.subjectId=o,t.value.subjectName=s,t.value.synopsis=b,n.value="update"}function L(o,s){confirm("确认删除吗？")&&m({url:`/api/subject/${o}`,method:"DELETE"}).then(b=>{r.value.splice(s,1)})}return U(()=>{T(f),_.value=f==I.state.username}),(o,s)=>{const b=R("router-link");return c(),i(j,null,[e("ul",G,[(c(!0),i(j,null,B(l(r),(a,h)=>(c(),i("li",{class:"list-group-item",key:h},[w(b,{to:{name:"subject_post",params:{subject_id:a.subjectId}}},{default:D(()=>[e("strong",{textContent:k(a.subjectName)},null,8,J)]),_:2},1032,["to"]),e("div",A,[e("button",{class:"btn btn-outline-danger float-end blog-btn",onClick:M=>L(a.subjectId,h)},"删除",8,H),l(_)?(c(),i("button",{key:0,class:"btn btn-outline-danger float-end blog-btn","data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:M=>F(a.subjectId,a.subjectName,a.synopsis)},"修改",8,Q)):g("",!0)]),e("div",null,k(a.synopsis),1)]))),128)),l(_)?(c(),i("li",q,[e("a",{"data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:s[0]||(s[0]=a=>(y(t)?t.value={}:t={},y(n)?n.value="insert":n="insert"))},"创建专辑")])):g("",!0)]),e("div",z,[e("div",K,[e("div",W,[X,e("div",Y,[e("div",Z,[ee,x(e("input",{class:"form-control",id:"exampleFormControlInput1","onUpdate:modelValue":s[1]||(s[1]=a=>l(t).subjectName=a)},null,512),[[C,l(t).subjectName]])]),e("div",te,[se,x(e("textarea",{class:"form-control",id:"exampleFormControlTextarea1",rows:"3","onUpdate:modelValue":s[2]||(s[2]=a=>l(t).synopsis=a)},null,512),[[C,l(t).synopsis]])])]),e("div",ae,[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",ref_key:"close",ref:p},"关闭",512),e("button",{type:"button",class:"btn btn-primary",onClick:S},"保存")])])])])],64)}}},de=E(oe,[["__scopeId","data-v-2dfc8930"]]);export{de as default};
