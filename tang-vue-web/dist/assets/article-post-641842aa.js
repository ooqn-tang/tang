import{I as O,L as z,u as U,e as n,J,g as K,t as Q,x as o,y as i,z as t,C as e,H as u,G as w,E as b,k as W,M as X,F as k,B as x,l as j,K as N,N as R,D as B,O as Y,P as Z}from"./router-5efffac6.js";import{s as _}from"./request-5c6f490a.js";import{_ as tt,i as et}from"./notice-fc687855.js";import{d as st,i as at,a as ot}from"./collect-4ec57750.js";import{a as lt}from"./subject-f5745b76.js";function nt(r){return _({url:"/api/remark",method:"post",data:r})}function it(r,p){return _({url:`/api/remark/${r}/list`,method:"get",params:{pageNum:p}})}const h=r=>(Y("data-v-1b650300"),r=r(),Z(),r),rt={class:"row"},ct={class:"col-md-9 col-lg-9"},dt={class:"row"},ut={class:"col-lg-12 small-col"},mt={class:"card mb-2 article-body"},_t={key:0,class:"card-body"},ht={id:"title"},bt={class:"time-font"},pt=h(()=>t("hr",null,null,-1)),ft=["innerHTML"],vt={key:1,class:"card-body"},kt={class:"card mb-2 article-body"},yt={class:"card-body"},gt=h(()=>t("label",{for:"exampleFormControlTextarea1",class:"form-label"},"评论",-1)),xt={class:"mb-2"},wt=h(()=>t("button",{class:"btn btn-outline-secondary btn-sm",type:"button"},"表情🙂",-1)),Tt={class:"card mb-2 article-body"},Ct={class:"card-body"},It={style:{color:"rgb(0, 89, 255)"}},At={class:"col-md-3 col-lg-3 d-md-inline small-col"},Lt={key:0,class:"list-group mb-2"},Et=h(()=>t("a",{class:"list-group-item active"},"专题",-1)),St={class:"list-group mb-2"},$t=h(()=>t("a",{class:"list-group-item active"},[w("推荐"),t("span",{class:"float-end"},"🎇")],-1)),jt=["href"],Nt={class:"navbar fixed-bottom navbar-light bg-light foot-navbar"},Rt={class:"container-fluid"},Bt={class:"col-md-12 col-lg-12 small-col"},Mt=h(()=>t("a",{class:"btn btn-outline-primary btn-sm mini-but",disabled:""},"举报",-1)),Pt=["href"],Vt=h(()=>t("a",{class:"btn btn-outline-primary btn-sm mini-but",onclick:"document.body.scrollTop = document.documentElement.scrollTop = 0"},"⬆TOP",-1)),Dt={__name:"article-post",setup(r){const p=z(),T=U();let m=n(1),c=n(p.query.value),C=n(!1),I=n([]),l=n({author:{}}),y=n([{remarkId:"1",text:"alksdjfkajsdf"},{remarkId:"1",text:"alksdjfkajsdf"}]),A=n(!1),g=n([]),f=n(0),M=n("加载中..."),v=n({});function L(s){m.value==2?_({url:`/api/fans/${s}`,method:"POST"}).then(d=>{m.value=1}):_({url:`/api/fans/${s}`,method:"DELETE"}).then(d=>{m.value=2})}function P(){v.value.dataId=c,nt(v.value).then(s=>{y.value.unshift(s.data),v.value.text=""})}function E(){it(c,0).then(s=>{y.value=s.data.content})}function V(){_({url:`/api/fans/username/${l.value.author.username}`,method:"get"}).then(s=>{s.data==1?m.value=1:m.value=2})}function D(){f.value>=1?st({url:window.location.href}).then(s=>{f.value=0}):at({dataId:c,url:window.location.href,title:l.value.title,synopsis:l.value.synopsis}).then(s=>{f.value=1})}function F(){ot({url:window.location.href}).then(s=>{f.value=s.data})}function q(){_({url:`/api/article/load/${c}`,method:"GET"}).then(s=>{l.value=s.data,A.value=T.username==l.value.author.username,V()})}function G(){lt(c).then(s=>{g.value=s.data})}function H(){_({url:"/api/article/recommend",method:"GET"}).then(s=>{I.value=s.data})}function S(){c=p.params.id,T.username!=""&&F(),G(),q()}return J(()=>{S(),H(),E()}),K(()=>p.params.id,()=>{S(),E(),document.body.scrollTop=document.documentElement.scrollTop=0}),(s,d)=>{const $=Q("router-link");return o(),i(k,null,[t("div",rt,[t("div",ct,[t("div",dt,[t("div",ut,[t("div",mt,[e(C)?b("",!0):(o(),i("div",_t,[t("h3",ht,[t("strong",null,u(e(l).title),1)]),t("div",null,[t("strong",null,u(e(l).author.nickname),1),w(" . "),t("span",bt,u(e(l).createTime),1),e(m)==2?(o(),i("button",{key:0,class:"btn btn-outline-warning float-end t-b-m-1",onClick:d[0]||(d[0]=a=>L(e(l).author.username))}," 订阅 ")):b("",!0),e(m)==1?(o(),i("button",{key:1,class:"btn btn-outline-warning float-end t-b-m-1",onClick:d[1]||(d[1]=a=>L(e(l).author.username))}," 取消订阅 ")):b("",!0),pt]),t("div",{class:"markdown-body",innerHTML:e(l).text},null,8,ft)])),e(C)?(o(),i("div",vt,u(e(M)),1)):b("",!0)]),t("div",kt,[t("div",yt,[gt,t("div",xt,[W(t("textarea",{class:"form-control",rows:"3",placeholder:"输入的内容不包含标签的内容会在最后追加标签中的内容。","onUpdate:modelValue":d[2]||(d[2]=a=>e(v).text=a)},null,512),[[X,e(v).text]])]),wt,t("button",{class:"btn btn-outline-secondary btn-sm float-end",type:"button",onClick:P},"发送")])]),(o(!0),i(k,null,x(e(y),a=>(o(),i("div",Tt,[t("div",Ct,[t("p",It,u(a.author!=null?a.author.nickname:"未知"),1),t("p",null,u(a.text),1)])]))),256))])])]),t("div",At,[e(g).length>0?(o(),i("div",Lt,[Et,(o(!0),i(k,null,x(e(g),a=>(o(),R($,{class:N(["list-group-item",a.articleId==e(l).articleId?"active2":""]),to:"/article/"+a.articleId},{default:B(()=>[t("div",null,u(a.title),1)]),_:2},1032,["class","to"]))),256))])):b("",!0),t("div",St,[$t,(o(!0),i(k,null,x(e(I),a=>(o(),i("a",{class:"list-group-item",href:"/article/"+a.articleId},u(a.title),9,jt))),256))]),j(tt),j(et)])]),t("nav",Nt,[t("div",Rt,[t("div",Bt,[t("a",{class:N([e(f)==1?"btn-outline-danger":"btn-outline-primary","btn btn-sm mini-but m-l-0"]),onClick:D},"收藏",2),Mt,t("a",{class:"btn btn-outline-primary btn-sm mini-but",href:"https://www.ooqn.com/article/"+e(c),target:"_blank"},"阅读模式",8,Pt),e(A)?(o(),R($,{key:0,class:"btn btn-outline-primary btn-sm mini-but",target:"_blank",to:{name:"article-editor-md",query:{article:e(c)}}},{default:B(()=>[w("修改")]),_:1},8,["to"])):b("",!0),Vt])])])],64)}}},zt=O(Dt,[["__scopeId","data-v-1b650300"]]);export{zt as default};
