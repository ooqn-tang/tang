import{u as M,L as E,d as i,J as S,t as U,x as d,y as r,z as e,F as f,B,C as l,n as h,E as y,k as j,P as g,l as V,D as $,G as k}from"./router-7246853f.js";import{s as m}from"./request-5c6f490a.js";const D={class:"list-group article-list"},w=["textContent"],P={class:"btn-group float-end"},G=["onClick"],J=["onClick"],O={key:0,class:"list-group-item"},R={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},z={class:"modal-dialog"},A={class:"modal-content"},q=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"专辑"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),H={class:"modal-body"},K={class:"mb-3"},Q=e("label",{for:"exampleFormControlInput1",class:"form-label"},"专辑名",-1),W={class:"mb-3"},X=e("label",{for:"exampleFormControlTextarea1",class:"form-label"},"描述",-1),Y={class:"modal-footer"},se={__name:"subject",setup(Z){let x=M(),C=E(),b=i(null),p=i(!1),u=i([]),t=i({subjectId:"",subjectName:"",synopsis:""}),n=i("update"),_=C.params.username;function N(o){m({url:`/api/subject/username/${o}`,method:"GET"}).then(s=>{u.value=s.data})}function T(){n.value=="insert"?m({url:"/api/subject",method:"POST",data:t.value}).then(o=>{u.value.unshift(o.data),b.value.click()}):m({url:"/api/subject",method:"PUT",data:t.value}).then(o=>{alert(JSON.stringify(o.data)),b.value.click()})}function F(o,s,c){t.value.subjectId=o,t.value.subjectName=s,t.value.synopsis=c,n.value="update"}function I(o,s){confirm("确认删除吗？")&&m({url:`/api/subject/${o}`,method:"DELETE"}).then(c=>{u.value.splice(s,1)})}return S(()=>{N(_),p.value=_==x.username}),(o,s)=>{const c=U("router-link");return d(),r(f,null,[e("ul",D,[(d(!0),r(f,null,B(l(u),(a,v)=>(d(),r("li",{class:"list-group-item",key:v},[V(c,{to:{name:"subject_post",params:{subject_id:a.subjectId}}},{default:$(()=>[e("strong",{textContent:k(a.subjectName)},null,8,w)]),_:2},1032,["to"]),e("div",P,[e("button",{class:"btn btn-outline-danger float-end blog-btn",onClick:L=>I(a.subjectId,v)},"删除",8,G),l(p)?(d(),r("button",{key:0,class:"btn btn-outline-danger float-end blog-btn","data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:L=>F(a.subjectId,a.subjectName,a.synopsis)},"修改",8,J)):y("",!0)]),e("div",null,k(a.synopsis),1)]))),128)),l(p)?(d(),r("li",O,[e("a",{"data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:s[0]||(s[0]=a=>(h(t)?t.value={}:t={},h(n)?n.value="insert":n="insert"))},"创建专辑")])):y("",!0)]),e("div",R,[e("div",z,[e("div",A,[q,e("div",H,[e("div",K,[Q,j(e("input",{class:"form-control",id:"exampleFormControlInput1","onUpdate:modelValue":s[1]||(s[1]=a=>l(t).subjectName=a)},null,512),[[g,l(t).subjectName]])]),e("div",W,[X,j(e("textarea",{class:"form-control",id:"exampleFormControlTextarea1",rows:"3","onUpdate:modelValue":s[2]||(s[2]=a=>l(t).synopsis=a)},null,512),[[g,l(t).synopsis]])])]),e("div",Y,[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",ref_key:"close",ref:b},"关闭",512),e("button",{type:"button",class:"btn btn-primary",onClick:T},"保存")])])])])],64)}}};export{se as default};
