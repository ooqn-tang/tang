import{G as U,J,u as K,a as i,H as Q,e as N,q as W,s as o,t as n,x as t,z as e,D as c,C as x,B as b,g as X,K as Y,F as y,y as g,j as R,I as q,L as B,A as M,M as Z,N as tt,n as et}from"./preload-helper-3003bc42.js";import{s as h}from"./request-651d32a9.js";import{_ as st,i as at}from"./info-e0b80c69.js";import{d as ot,i as lt,a as nt}from"./collect-b665d4b5.js";import{a as it}from"./subject-eedf1819.js";function rt(d){return h({url:"/api/remark",method:"post",data:d})}function ct(d,f){return h({url:`/api/remark/${d}/list`,method:"get",params:{pageNum:f}})}const m=d=>(Z("data-v-3fada9e6"),d=d(),tt(),d),dt={class:"row"},ut={class:"col-md-9 col-lg-9"},mt={class:"row"},_t={class:"col-lg-12 small-col"},ht={class:"card mb-2 article-body"},pt={key:0,class:"card-body"},bt={id:"title"},ft={class:"time-font"},vt=m(()=>t("hr",null,null,-1)),kt=["innerHTML"],yt={key:1,class:"card-body"},gt={class:"card mb-2"},xt={class:"card-body"},wt=m(()=>t("label",{for:"exampleFormControlTextarea1",class:"form-label"},"评论",-1)),Tt={class:"mb-2"},Ct=m(()=>t("button",{class:"btn btn-outline-secondary btn-sm",type:"button"},"表情🙂",-1)),It={class:"card mb-2"},At={class:"card-body"},Lt={style:{color:"rgb(0, 89, 255)"}},St={class:"col-md-3 col-lg-3 d-md-inline small-col"},Et={key:0,class:"list-group mb-2"},$t=m(()=>t("a",{class:"list-group-item active"},"专题",-1)),jt={class:"list-group mb-2"},Nt=m(()=>t("a",{class:"list-group-item active"},[x("推荐"),t("span",{class:"float-end"},"🎇")],-1)),Rt=["href"],qt={class:"list-group mb-2",style:{position:"sticky",top:"10px"}},Bt=m(()=>t("a",{class:"list-group-item active"},[x("目录"),t("span",{class:"float-end"},"🎇")],-1)),Mt=["id","href"],Vt={class:"navbar fixed-bottom navbar-light bg-light foot-navbar"},Dt={class:"container-fluid"},Ft={class:"row"},Pt={class:"col-md-12 col-lg-12 small-col",style:{"padding-top":"5px","padding-bottom":"5px"}},Gt=m(()=>t("a",{class:"btn btn-outline-primary btn-sm mini-but",disabled:""},"举报",-1)),Ht=["href"],zt=m(()=>t("a",{class:"btn btn-outline-primary btn-sm mini-but",onclick:"document.body.scrollTop = document.documentElement.scrollTop = 0"},"⬆TOP",-1)),Ot={__name:"article-post",setup(d){const f=J(),C=K();let _=i(1),u=i(f.query.value),I=i(!1),A=i([]),l=i({author:{}}),w=i([{remarkId:"1",text:"alksdjfkajsdf"},{remarkId:"1",text:"alksdjfkajsdf"}]),L=i(!1),T=i([]),v=i(0),V=i("加载中..."),S=i([]),k=i({});function E(s){_.value==2?h({url:`/api/fans/${s}`,method:"POST"}).then(r=>{_.value=1}):h({url:`/api/fans/${s}`,method:"DELETE"}).then(r=>{_.value=2})}function D(){k.value.dataId=u,rt(k.value).then(s=>{w.value.unshift(s.data),k.value.text=""})}function $(){ct(u,0).then(s=>{w.value=s.data.content})}function F(){h({url:`/api/fans/username/${l.value.author.username}`,method:"get"}).then(s=>{s.data==1?_.value=1:_.value=2})}function P(){v.value>=1?ot({url:window.location.href}).then(s=>{v.value=0}):lt({dataId:u,url:window.location.href,title:l.value.title,synopsis:l.value.synopsis}).then(s=>{v.value=1})}function G(){nt({url:window.location.href}).then(s=>{v.value=s.data})}function H(){h({url:`/api/article/load/${u}`,method:"GET"}).then(s=>{l.value=s.data,L.value=C.author.username==l.value.author.username,F()})}function z(){it(u).then(s=>{T.value=s.data.dataArray})}function O(){h({url:"/api/article/recommend",method:"GET"}).then(s=>{A.value=s.data})}function j(){u=f.params.id,C.username!=""&&G(),z(),H()}return Q(()=>{j(),O(),$()}),N(()=>f.params.id,()=>{j(),$(),document.body.scrollTop=document.documentElement.scrollTop=0}),N(()=>l.value.text,async()=>{await et();let s=document.querySelectorAll(".markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6");debugger;let r=[];for(let p=0;p<s.length;p++){let a=s[p];r.push({id:a.id,text:a.innerText})}S.value=r}),(s,r)=>{const p=W("router-link");return o(),n(y,null,[t("div",dt,[t("div",ut,[t("div",mt,[t("div",_t,[t("div",ht,[e(I)?b("",!0):(o(),n("div",pt,[t("h3",bt,[t("strong",null,c(e(l).title),1)]),t("div",null,[t("strong",null,c(e(l).author.nickname),1),x(" . "),t("span",ft,c(e(l).createTime),1),e(_)==2?(o(),n("button",{key:0,class:"btn btn-outline-warning float-end t-b-m-1",onClick:r[0]||(r[0]=a=>E(e(l).author.username))}," 订阅 ")):b("",!0),e(_)==1?(o(),n("button",{key:1,class:"btn btn-outline-warning float-end t-b-m-1",onClick:r[1]||(r[1]=a=>E(e(l).author.username))}," 取消订阅 ")):b("",!0),vt]),t("div",{class:"markdown-body",innerHTML:e(l).text},null,8,kt)])),e(I)?(o(),n("div",yt,c(e(V)),1)):b("",!0)]),t("div",gt,[t("div",xt,[wt,t("div",Tt,[X(t("textarea",{class:"form-control",rows:"3",placeholder:"输入的内容不包含标签的内容会在最后追加标签中的内容。","onUpdate:modelValue":r[2]||(r[2]=a=>e(k).text=a)},null,512),[[Y,e(k).text]])]),Ct,t("button",{class:"btn btn-outline-secondary btn-sm float-end",type:"button",onClick:D},"发送")])]),(o(!0),n(y,null,g(e(w),a=>(o(),n("div",It,[t("div",At,[t("p",Lt,c(a.author!=null?a.author.nickname:"未知"),1),t("p",null,c(a.text),1)])]))),256))])])]),t("div",St,[e(T).length>0?(o(),n("div",Et,[$t,(o(!0),n(y,null,g(e(T),a=>(o(),B(p,{class:q(["list-group-item",a.articleId==e(l).articleId?"active2":""]),to:"/article/"+a.articleId},{default:M(()=>[t("div",null,c(a.title),1)]),_:2},1032,["class","to"]))),256))])):b("",!0),t("div",jt,[Nt,(o(!0),n(y,null,g(e(A),a=>(o(),n("a",{class:"list-group-item",href:"/article/"+a.articleId},c(a.title),9,Rt))),256))]),R(st),R(at),t("div",qt,[Bt,(o(!0),n(y,null,g(e(S),a=>(o(),n("a",{class:"list-group-item",id:a.id,href:"#"+a.id},c(a.text),9,Mt))),256))])])]),t("nav",Vt,[t("div",Dt,[t("div",Ft,[t("div",Pt,[t("a",{class:q([e(v)==1?"btn-outline-danger":"btn-outline-primary","btn btn-sm mini-but m-l-0"]),onClick:P},"收藏",2),Gt,t("a",{class:"btn btn-outline-primary btn-sm mini-but",href:"https://www.ooqn.com/article/"+e(u),target:"_blank"},"阅读模式",8,Ht),e(L)?(o(),B(p,{key:0,class:"btn btn-outline-primary btn-sm mini-but",target:"_blank",to:{name:"article-editor-md",query:{article:e(u)}}},{default:M(()=>[x("修改")]),_:1},8,["to"])):b("",!0),zt])])])])],64)}}},Xt=U(Ot,[["__scopeId","data-v-3fada9e6"]]);export{Xt as default};
