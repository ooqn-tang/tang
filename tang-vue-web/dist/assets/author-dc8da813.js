import{s as C}from"./request-5c6f490a.js";import{l as B,u as b}from"./role-fe075bc2.js";import{N as E,a as F}from"./DrawerContent-f96b66e6.js";import{e as r,J as T,x as V,y as $,l as t,D as a,C as o,F as g,G as i,h as f}from"./router-90a9ef51.js";import{a as c,b as w}from"./Space-ff1a9f42.js";import{F as s}from"./Dropdown-3c0ff2bc.js";import"./admin-cb7b1048.js";import"./notice-171a1c5e.js";import"./use-is-composing-ce3d7873.js";function z(n){return C({url:`api/admin/role/author/${n}`,method:"get"})}function G(n){return C({url:"/api/admin/author",method:"GET",params:n})}const H={__name:"author",setup(n){const d=r(!1),p=r([]),h=r([]),k=r([]),m=r([]),A=r({}),v=r({}),R=[{title:"用户名",key:"username"},{title:"昵称",key:"nickname"},{title:"邮箱",key:"mail"},{title:"操作",key:"actions",width:"250",render(e){return f(c,[f(s,{size:"small",onClick:async()=>{m.value=[],z(e.authorId).then(l=>{for(let u of l.data)m.value.push(u.roleId)}),v.value=e,d.value=!0}},{default:()=>"角色"}),f(s,{size:"small",onClick:()=>sendMail(e)},{default:()=>"编辑"})])}}],_=[{type:"selection"},{title:"名称",key:"roleName"},{title:"值",key:"roleValue"}],N=e=>e.roleId,y=()=>{G(A.value).then(e=>{p.value=e.data})},I=()=>{B().then(e=>{h.value=e.data})},x=e=>{k.value=e},D=()=>{b(v.value.authorId,k.value)};return T(async()=>{y(),I()}),(e,l)=>(V(),$(g,null,[t(o(c),{vertical:""},{default:a(()=>[t(o(c),null,{default:a(()=>[t(o(s),{type:"primary",onClick:y},{default:a(()=>[i("查询")]),_:1})]),_:1}),t(o(w),{columns:R,data:p.value,bordered:!0},null,8,["data"])]),_:1}),t(o(F),{show:d.value,"onUpdate:show":l[2]||(l[2]=u=>d.value=u),width:600},{default:a(()=>[t(o(E),null,{header:a(()=>[i(" 角色管理 ")]),footer:a(()=>[t(o(c),null,{default:a(()=>[t(o(s),{onClick:l[0]||(l[0]=u=>D())},{default:a(()=>[i("保存")]),_:1}),t(o(s),{onClick:l[1]||(l[1]=u=>d.value=!1)},{default:a(()=>[i("取消")]),_:1})]),_:1})]),default:a(()=>[t(o(w),{columns:_,data:h.value,"row-key":N,"default-checked-row-keys":m.value,"onUpdate:checkedRowKeys":x},null,8,["data","default-checked-row-keys"])]),_:1})]),_:1},8,["show"])],64))}};export{H as default};
