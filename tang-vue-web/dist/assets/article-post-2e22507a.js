import{G as z,J as O,u as U,a as i,H as J,e as N,l as K,q as o,t as l,x as t,z as e,D as c,C as g,B as _,g as Q,K as W,F as y,y as w,j as R,I as B,L as X,A as Y,M as Z,N as tt,n as et}from"./preload-helper-b3ec2021.js";import{s as p,f as st}from"./request-596b05ba.js";import{_ as at,i as ot}from"./info-3da8b178.js";import{d as lt,i as nt,a as it}from"./collect-78643e43.js";import{a as rt}from"./subject-00162416.js";function ct(d){return p({url:"/api/remark",method:"post",data:d})}function dt(d,f){return p({url:`/api/remark/${d}/list`,method:"get",params:{pageNum:f}})}const m=d=>(Z("data-v-5339fbd4"),d=d(),tt(),d),ut={class:"row mb-5"},mt={class:"col-md-9 col-lg-9"},ht={class:"row"},_t={class:"col-lg-12 small-col"},pt={class:"card mb-2 article-body"},ft={key:0,class:"card-body"},bt={id:"title"},vt={class:"author-name"},kt={class:"time-font"},yt=m(()=>t("hr",null,null,-1)),gt=["innerHTML"],xt={key:1,class:"card-body"},wt={class:"card mb-2"},Tt={class:"card-body"},Ct=m(()=>t("label",{for:"exampleFormControlTextarea1",class:"form-label"},"评论",-1)),It={class:"mb-2"},At=m(()=>t("button",{class:"btn btn-outline-secondary btn-sm",type:"button"},"表情🙂",-1)),Lt={class:"card mb-2"},St={class:"card-body"},Et={class:"author-name"},$t={key:0,class:"float-end"},jt={class:"time-font"},Nt={class:"col-md-3 col-lg-3 d-md-inline small-col"},Rt={key:0,class:"list-group mb-2"},Bt=m(()=>t("a",{class:"list-group-item active"},"专题",-1)),Mt={class:"list-group mb-2"},Vt=m(()=>t("a",{class:"list-group-item active"},[g("推荐"),t("span",{class:"float-end"},"🎇")],-1)),qt=["href"],Dt={class:"list-group mb-2",style:{position:"sticky",top:"10px"}},Ft=m(()=>t("a",{class:"list-group-item active"},[g("目录"),t("span",{class:"float-end"},"🎇")],-1)),Pt=["id","href"],Gt={class:"navbar fixed-bottom navbar-light bg-light foot-navbar p-0"},Ht={class:"container-fluid"},zt={class:"row"},Ot={class:"col-md-12 col-lg-12 small-col",style:{"padding-top":"3px","padding-bottom":"5px"}},Ut=m(()=>t("a",{class:"btn btn-outline-primary btn-sm ssm me-1",disabled:""},"举报",-1)),Jt=["href"],Kt=["href"],Qt=m(()=>t("a",{class:"btn btn-outline-primary btn-sm ssm me-1",onclick:"document.body.scrollTop = document.documentElement.scrollTop = 0"},"⬆TOP",-1)),Wt={__name:"article-post",setup(d){const f=O(),I=U();let h=i(1),u=i(f.query.value),A=i(!1),L=i([]),n=i({author:{}}),T=i([{remarkId:"1",text:"alksdjfkajsdf"},{remarkId:"1",text:"alksdjfkajsdf"}]),x=i(!1),C=i([]),b=i(0),M=i("加载中..."),S=i([]),v=i({});function E(a){h.value==2?p({url:`/api/fans/${a}`,method:"POST"}).then(r=>{h.value=1}):p({url:`/api/fans/${a}`,method:"DELETE"}).then(r=>{h.value=2})}function V(){v.value.dataId=u,ct(v.value).then(a=>{T.value.unshift(a.data),v.value.text=""})}function $(){dt(u,0).then(a=>{T.value=a.data.content})}function q(){p({url:`/api/fans/username/${n.value.author.username}`,method:"get"}).then(a=>{a.data==1?h.value=1:h.value=2})}function D(){x.value?b.value>=1?lt({url:window.location.href}).then(a=>{b.value=0}):nt({dataId:u,url:window.location.href,title:n.value.title,synopsis:n.value.synopsis}).then(a=>{b.value=1}):alert("请登录！")}function F(){it({url:window.location.href}).then(a=>{b.value=a.data})}function P(){p({url:`/api/article/load/${u}`,method:"GET"}).then(a=>{n.value=a.data,x.value=I.author.username==n.value.author.username,x.value&&(F(),q())})}function G(){rt(u).then(a=>{C.value=a.data.dataArray})}function H(){p({url:"/api/article/recommend",method:"GET"}).then(a=>{L.value=a.data})}function j(){u=f.params.id,G(),P()}return J(()=>{j(),H(),$()}),N(()=>f.params.id,()=>{j(),$(),document.body.scrollTop=document.documentElement.scrollTop=0}),N(()=>n.value.text,async()=>{await et();let a=document.querySelectorAll(".markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6"),r=[];for(let k=0;k<a.length;k++){let s=a[k];r.push({id:s.id,text:s.innerText})}S.value=r}),(a,r)=>{const k=K("router-link");return o(),l(y,null,[t("div",ut,[t("div",mt,[t("div",ht,[t("div",_t,[t("div",pt,[e(A)?_("",!0):(o(),l("div",ft,[t("h3",bt,[t("strong",null,c(e(n).title),1)]),t("div",null,[t("strong",vt,c(e(n).author.nickname),1),g(" . "),t("span",kt,c(e(n).createTime),1),e(h)==2?(o(),l("button",{key:0,class:"btn btn-outline-warning float-end btn-sm ssm",onClick:r[0]||(r[0]=s=>E(e(n).author.username))}," 订阅 ")):_("",!0),e(h)==1?(o(),l("button",{key:1,class:"btn btn-outline-warning float-end btn-sm ssm",onClick:r[1]||(r[1]=s=>E(e(n).author.username))}," 取消订阅 ")):_("",!0),yt]),t("div",{class:"markdown-body",innerHTML:e(n).text},null,8,gt)])),e(A)?(o(),l("div",xt,c(e(M)),1)):_("",!0)]),t("div",wt,[t("div",Tt,[Ct,t("div",It,[Q(t("textarea",{class:"form-control",rows:"3",placeholder:"输入的内容不包含标签的内容会在最后追加标签中的内容。","onUpdate:modelValue":r[2]||(r[2]=s=>e(v).text=s)},null,512),[[W,e(v).text]])]),At,t("button",{class:"btn btn-outline-secondary btn-sm float-end",type:"button",onClick:V},"发送")])]),(o(!0),l(y,null,w(e(T),s=>(o(),l("div",Lt,[t("div",St,[t("p",Et,[g(c(s.author!=null?s.author.nickname:"未知")+" ",1),s.author!=null&&e(I).author.username==s.author.username?(o(),l("span",$t,"删除")):_("",!0)]),t("p",null,[g(c(s.text)+" ",1),t("span",jt,c(e(st)(s.createTime)),1)])])]))),256))])])]),t("div",Nt,[e(C).length>0?(o(),l("div",Rt,[Bt,(o(!0),l(y,null,w(e(C),s=>(o(),X(k,{class:B(["list-group-item",s.articleId==e(n).articleId?"active2":""]),to:"/article/"+s.articleId},{default:Y(()=>[t("div",null,c(s.title),1)]),_:2},1032,["class","to"]))),256))])):_("",!0),t("div",Mt,[Vt,(o(!0),l(y,null,w(e(L),s=>(o(),l("a",{class:"list-group-item",href:"/article/"+s.articleId},c(s.title),9,qt))),256))]),R(at),R(ot),t("div",Dt,[Ft,(o(!0),l(y,null,w(e(S),s=>(o(),l("a",{class:"list-group-item",id:s.id,href:"#"+s.id},c(s.text),9,Pt))),256))])])]),t("nav",Gt,[t("div",Ht,[t("div",zt,[t("div",Ot,[t("a",{class:B([e(b)==1?"btn-outline-danger":"btn-outline-primary","btn btn-sm ssm m-l-0 me-1"]),onClick:D},"收藏",2),Ut,t("a",{class:"btn btn-outline-primary btn-sm ssm me-1",href:"https://www.ooqn.com/article/"+e(u),target:"_blank"},"阅读模式",8,Jt),e(x)?(o(),l("a",{key:0,class:"btn btn-outline-primary btn-sm ssm me-1",target:"_blank",href:"/article-editor-md?article="+e(u)},"修改",8,Kt)):_("",!0),Qt])])])])],64)}}},se=z(Wt,[["__scopeId","data-v-5339fbd4"]]);export{se as default};
