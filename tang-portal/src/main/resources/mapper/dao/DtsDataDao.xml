<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="net.ttcxy.tang.portal.mapper.dao.DtsDataDao">

    <select id="selectDataStatCount" resultType="net.ttcxy.tang.portal.entity.dto.DtsDataCount">
        select
        (select count(data_id) from dts_like where data_id = t11.data_id) 'like',
        (select count(data_id) from cts_coin where data_id = t11.data_id) 'coin',
        (select count(data_id) from (select data_id,author_id,create_date,count(*) from dts_view group by data_id,author_id,create_date) t where data_id = t11.data_id) 'view',
        (select count(data_id) from dts_comment where data_id = t11.data_id) 'comment'
        from (
        select article_id data_id from dts_article where article_id = #{dataId}
        union all
        select video_id data_id from dts_video where video_id = #{dataId}
        ) t11
    </select>
    <select id="selectDataType" resultType="java.lang.Integer">
        select
        type
        from (
        select article_id data_id,'1' type from dts_article where article_id = #{dataId}
        union all
        select video_id data_id,'2' type from dts_video where video_id = #{dataId}
        ) t11
    </select>
    <select id="selectDataAuthorId" resultType="java.lang.String">
        select
        author_id
        from (
        select author_id from dts_article where article_id = #{dataId}
        union all
        select author_id from dts_video where video_id = #{dataId}
        ) t11
    </select>
</mapper>