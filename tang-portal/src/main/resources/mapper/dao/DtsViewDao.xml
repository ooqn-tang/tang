<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="net.ttcxy.tang.portal.mapper.dao.DtsViewDao">

    <select id="list" resultType="net.ttcxy.tang.portal.entity.dto.DtsViewDto">
        select t1.data_id,t1.create_time,t2.title,t3.nickname,t3.username,t2.type,t3.head_url
        from dts_view t1,
        (
        select article_id data_id,title,author_id,create_date,'article' type from dts_article
        union
        select video_id data_id,title,author_id,create_date,'video' type from dts_video
        ) t2,
        uts_author t3
        where t1.data_id = t2.data_id and t3.author_id = t2.author_id
        <if test="type != null and type != ''">
            and type = #{type}
        </if>
        order by t1.create_time desc
    </select>
</mapper>